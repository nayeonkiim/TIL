---
id: MySQL3
title: 집계와 서브쿼리
---

## 대표적인 집계함수 COUNT
```sql
COUNT(집합)
```
- COUNT() 집계함수로 행 개수를 구할 수 있다.
- `SELECT COUNT(*) FROM sample`
    - sample 테이블의 행의 갯수를 반환한다.
- 집계함수는 복수의 값(집합)에서 최종적으로 하나의 값을 계산해낸다.
- 집합 안에 NULL 값이 있을 경우 무시한다.
    - 즉 만약 name 필드의 값이 NULL인 경우, COUNT(name)을 하면 NULL인 필드를 제외한 결과가 리턴된다.
- **DISTINCT**로 중복 제거하기
    - 만약 name 필드가 'A'인 데이터가 두개 있을 떼
    - `SELECT DISTINCT name FROM sample` 실행 시
    - 중복이 제거 되어 A 는 하나만 리턴 된다. 
- 집계 함수에서 DISTINCT
    - 상황 : name 필드에서 NULL 값을 제외하고, 중복하지 않는 데이터의 개수(A,B,C 3개)을 구하는 경우
    - COUNT 함수, DISTINCT 함수, WHERE 구의 조건을 지정해 구할 수 있는 방법은 없다.
    - SELECT DISTINCT COUNT(name) 은 불가능하다. -> COUNT() 가 먼저 계산된다.
    - 방법은 집계함수의 인수로 DISTINCT을 사용한 수식을 지정하는 것이다.
        - `SELECT COUNT(name), COUNT(DISTINCT name) FROM sample`
            - DISTINCT를 이용해 집합에서 중복을 제거한 뒤 COUNT로 개수를 구할 수 있다.

## COUNT 이외의 집계함수
```sql
SUM(집합)
AVG(집합)
MIN(집합)
MAX(집합)
```
- SUM : 집합의 합계를 구한다.
- AVG : 집합의 평균값을 구한다.
- MIN, MAX : 집합의 최솟값, 최댓값을 구한다.

## GROUP BY(그룹화)
- 특정 컬럼을 기준으로 그룹화 할 수 있다.
- 그룹화를 하면 조회된 데이터를 통계 내기 위한 집계함수(COUNT, SUM 등) 을 사용하기에 용이해진다.

```sql
SELECT * FROM 테이블명 GROUP BY 열1, 열2, ...
```
- name 열이 A인 행이 두개, B와 C인 행은 각각 한개 씩 있는 경우에 
- `SELECT name FROM sample GROUP BY name;` 를 통해 name 열에서 같은 값을 가진 행끼지 한데 묶어 그룹화한 집합을 집계함수에 넘겨줄 수 있다.
- GROUP BY를 지정해 그룹화하면 DISTINCT와 같이 중복을 제거하는 효과가 있다.
- GROUP BY 구와 집계함수를 조합
    - `SELECT name, COUNT(name), SUM(quantity) FROM sample GROUP BY name;`
        



